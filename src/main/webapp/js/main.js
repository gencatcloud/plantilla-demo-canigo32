$(document).ready(function(){function a(){$.ajax({url:"api/logs/list"}).then(function(a){var b="";$.each(a,function(c){b+="DEBUG"==a[c].level?'<li data-rowid="'+a[c].name+'"><div class="logName">'+a[c].name+'</div><a href="#"><input type="button" value="DEBUG" style="background-color:green"/><input type="button" value="INFO" /><input type="button" value="ERROR" /><input type="button"value="FATAL" /><input type="button" value="WARN" /></a></li>':"INFO"==a[c].level?'<li data-rowid="'+a[c].name+'"><div class="logName">'+a[c].name+'</div><a href="#"><input type="button" value="DEBUG" /><input type="button" value="INFO" style="background-color:green"/><input type="button" value="ERROR" /><input type="button" value="FATAL" /><input type="button" value="WARN" /></a></li>':"ERROR"==a[c].level?'<li data-rowid="'+a[c].name+'"><div class="logName">'+a[c].name+'</div><a href="#"><input type="button" value="DEBUG" /><input type="button" value="INFO" /><input type="button" value="ERROR" style="background-color:green"/><input type="button" value="FATAL" /><input type="button" value="WARN" /></a></li>':"FATAL"==a[c].level?'<li data-rowid="'+a[c].name+'"><div class="logName">'+a[c].name+'</div><a href="#"><input type="button" value="DEBUG" /><input type="button" value="INFO" /><input type="button" value="ERROR" /><input type="button" value="FATAL" style="background-color:green"/><input type="button" value="WARN" /></a></li>':"WARN"==a[c].level?'<li data-rowid="'+a[c].name+'"><div class="logName">'+a[c].name+'</div><a href="#"><input type="button" value="DEBUG" /><input type="button" value="INFO" /><input type="button" value="ERROR" /><input type="button" value="FATAL" /><input type="button" value="WARN" style="background-color:green"/></a></li>':'<li data-rowid="'+a[c].name+'"><div class="logName">'+a[c].name+'</div><a href="#"><input type="button" value="DEBUG" /><input type="button" value="INFO" /><input type="button" value="ERROR" /><input type="button" value="FATAL" /><input type="button" value="WARN" /></a></li>'}),$("#thelist").empty().append(b)})}function b(){null!=d&&$.ajax({type:"PUT",url:"api/logs/keepwatch",data:d,contentType:"application/json; charset=utf-8",success:function(a){},error:function(a){}})}var c,d=null;jQuery(".tabs .tab-links a").on("click",function(a){var b=jQuery(this).attr("href");jQuery(".tabs "+b).show().siblings().hide(),jQuery(this).parent("li").addClass("active").siblings().removeClass("active"),a.preventDefault(),$("#selectAppender").find("option").remove(),(b="#tab2")&&$.ajax({url:"api/logs/appenders"}).then(function(a){$.each(a,function(b){$("#selectAppender").append($("<option>",{value:b,text:a[b].fileName}))})})}),a(),$("#thelist").on("click","li input",function(b){var c=$(this).parents("li").data("rowid"),d=$(this).val(),e={};e.name=c,e.level=d,$.ajax({type:"PUT",url:"api/logs/change",data:JSON.stringify(e),dataType:"json",contentType:"application/json; charset=utf-8",success:function(b){a()},error:function(a){alert("Ha fallat el canvi de logs")}})}),$("#connectar").click(function(){var a=$("#selectAppender option:selected").val();$.ajax({type:"PUT",url:"api/logs/startwatch",data:a,contentType:"application/json; charset=utf-8",success:function(b){var e=window.location.href,f=e.lastIndexOf("/"),g=e.substring(0,f+1);c=new SockJS(g+"api/watch"),stompClient=Stomp.over(c),stompClient.connect({},function(c){$("#desconnectar").prop("disabled",!1),$("#connectar").prop("disabled",!0),d=a,$("#connectionStatusIcon").removeClass(),$("#connectionStatusIcon").addClass("fa fa-lg fa-check-circle"),stompClient.subscribe(b,function(a){addLogMessage(a.body)})})},error:function(a){}})}),$("#desconnectar").click(function(){null!=d&&$.ajax({type:"PUT",url:"api/logs/stopwatch",data:d,contentType:"application/json; charset=utf-8",success:function(a){c.close(),$("#connectionStatusIcon").removeClass(),$("#connectionStatusIcon").addClass("fa fa-lg fa-exclamation-triangle"),d=null,$("#desconnectar").prop("disabled",!0),$("#connectar").prop("disabled",!1)},error:function(a){}})}),$("#downloadLog").click(function(a){var b=$("#selectAppender option:selected").val(),c=document.createElement("a");c.setAttribute("href","api/logs/downloadLog/"+b),window.location.href=c.href}),$("#clearButton").click(function(a){$("#logContent").empty()}),$("#connectionStatusIcon").addClass("fa fa-lg fa-exclamation-triangle"),$("#desconnectar").prop("disabled",!0),setInterval(b,18e5)});